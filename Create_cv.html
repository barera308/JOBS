<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced CV Creator</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
<style>
  body { font-family: 'Inter', sans-serif; }
  .dynamic-item { position: relative; margin-bottom:0.5rem; }
  .remove-btn { position: absolute; top:0; right:0; transform: translate(50%, -50%); background:red; color:white; border:none; border-radius:50%; width:20px; height:20px; cursor:pointer; }
  .cv-container { background:white; padding:1rem; border-radius:0.5rem; box-shadow:0 0 10px rgba(0,0,0,0.1);}
  #cvPreview img { max-width:120px; border-radius:50%; margin-bottom:1rem; }
</style>
</head>
<body class="bg-gray-100 p-4">

<h1 class="text-3xl font-bold mb-4 text-center">Advanced CV Creator</h1>

<div class="grid grid-cols-1 md:grid-cols-2 gap-6">

<!-- Input Section -->
<div class="space-y-4">

<h2 class="font-bold text-xl">Personal Information</h2>
<input id="nameInput" placeholder="Full Name" class="border p-2 w-full"/>
<input id="emailInput" placeholder="Email" class="border p-2 w-full"/>
<input id="phoneInput" placeholder="Phone" class="border p-2 w-full"/>
<input id="addressInput" placeholder="Address" class="border p-2 w-full"/>
<textarea id="bioInput" placeholder="Short Bio" class="border p-2 w-full" rows="3"></textarea>

<label class="block mt-2">Profile Picture:</label>
<input type="file" id="photoInput" accept="image/*"/>

<!-- Dynamic Sections -->
<div>
<h3 class="font-bold mt-2">Qualifications / Education</h3>
<ul id="qualificationsContainer" class="space-y-2 list-disc list-inside"></ul>
<button onclick="addItem('qualifications')" class="bg-teal-500 text-white px-2 py-1 rounded">+ Add Qualification</button>
</div>

<div>
<h3 class="font-bold mt-2">Work Experience</h3>
<ul id="experienceContainer" class="space-y-2 list-disc list-inside"></ul>
<button onclick="addItem('experience')" class="bg-orange-500 text-white px-2 py-1 rounded">+ Add Experience</button>
</div>

<div>
<h3 class="font-bold mt-2">Courses / Training</h3>
<ul id="coursesContainer" class="space-y-2 list-disc list-inside"></ul>
<button onclick="addItem('courses')" class="bg-purple-500 text-white px-2 py-1 rounded">+ Add Course</button>
</div>

<div>
<h3 class="font-bold mt-2">Publications</h3>
<ul id="publicationsContainer" class="space-y-2 list-disc list-inside"></ul>
<button onclick="addItem('publications')" class="bg-blue-500 text-white px-2 py-1 rounded">+ Add Publication</button>
</div>

<div>
<h3 class="font-bold mt-2">References</h3>
<ul id="referencesContainer" class="space-y-2 list-disc list-inside"></ul>
<button onclick="addItem('references')" class="bg-gray-700 text-white px-2 py-1 rounded">+ Add Reference</button>
</div>

<div class="mt-4 space-x-2">
<button onclick="downloadPDF()" class="bg-blue-600 text-white px-4 py-2 rounded">Download PDF</button>
<button onclick="downloadWord()" class="bg-green-600 text-white px-4 py-2 rounded">Download Word</button>
</div>

</div>

<!-- Preview Section -->
<div class="cv-container" id="cvPreview">
<img id="photoPreview" src="" alt="Profile Photo" style="display:none"/>
<h2 id="namePreview" class="text-2xl font-bold">Your Name</h2>
<p id="emailPreview">Email</p>
<p id="phonePreview">Phone</p>
<p id="addressPreview">Address</p>
<p id="bioPreview">Bio</p>

<h3 class="font-bold mt-4">Qualifications</h3>
<ul id="qualificationsPreview"></ul>

<h3 class="font-bold mt-4">Experience</h3>
<ul id="experiencePreview"></ul>

<h3 class="font-bold mt-4">Courses / Training</h3>
<ul id="coursesPreview"></ul>

<h3 class="font-bold mt-4">Publications</h3>
<ul id="publicationsPreview"></ul>

<h3 class="font-bold mt-4">References</h3>
<ul id="referencesPreview"></ul>
</div>

</div>

<script>
// Personal info bindings
const personalFields = ['name','email','phone','address','bio'];
personalFields.forEach(f=>{
  const input = document.getElementById(f+'Input');
  const preview = document.getElementById(f+'Preview');
  input.addEventListener('input', ()=> preview.textContent = input.value || preview.dataset.placeholder);
  preview.dataset.placeholder = preview.textContent;
});

// Profile photo
const photoInput = document.getElementById('photoInput');
const photoPreview = document.getElementById('photoPreview');
photoInput.addEventListener('change', ()=>{
  const file = photoInput.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = e => {
      photoPreview.src = e.target.result;
      photoPreview.style.display='block';
    }
    reader.readAsDataURL(file);
  }
});

// Dynamic sections
const sections = ['qualifications','experience','courses','publications','references'];
sections.forEach(section=>{
  window[section+'Container'] = document.getElementById(section+'Container');
  window[section+'Preview'] = document.getElementById(section+'Preview');
  Sortable.create(window[section+'Container'], { animation: 150, onSort: ()=>updatePreview(section) });
});

function addItem(section){
  const li = document.createElement('li');
  li.className='dynamic-item';
  li.innerHTML=`<input placeholder="Enter item" class="border p-1 w-3/4"/> <button class="remove-btn">X</button>`;
  window[section+'Container'].appendChild(li);

  const input = li.querySelector('input');
  input.addEventListener('input', ()=>updatePreview(section));

  li.querySelector('.remove-btn').addEventListener('click', ()=>{
    li.remove();
    updatePreview(section);
  });

  updatePreview(section);
}

function updatePreview(section){
  const preview = window[section+'Preview'];
  preview.innerHTML='';
  window[section+'Container'].querySelectorAll('input').forEach(inp=>{
    if(inp.value.trim()!==''){
      const li = document.createElement('li');
      li.textContent = inp.value;
      preview.appendChild(li);
    }
  });
}

// Download functions
function downloadPDF(){
  html2canvas(document.getElementById('cvPreview'),{scale:2}).then(canvas=>{
    const img = canvas.toDataURL('image/jpeg');
    const pdf = new jspdf.jsPDF();
    pdf.addImage(img,'JPEG',0,0,210,canvas.height*210/canvas.width);
    pdf.save('CV.pdf');
  });
}

function downloadWord(){
  const content = document.getElementById('cvPreview').innerHTML;
  const blob = new Blob([content], {type:'application/msword'});
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'CV.doc';
  a.click();
  URL.revokeObjectURL(a.href);
}
</script>

</body>
</html>
