<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Job Discussion Forum</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background: #f5f5f5; }
  form { background: white; padding: 20px; border-radius: 5px; margin-bottom: 20px; }
  input, textarea { width: 100%; padding: 10px; margin-bottom: 10px; }
  button { padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 5px; }
  button:hover { background: #218838; cursor: pointer; }
  .discussion-box { background: white; padding: 10px; border-radius: 5px; margin-bottom: 10px; }
  .discussion-box strong { color: #007bff; }
  .timestamp { font-size: 0.8em; color: #555; }
</style>
</head>
<body>

<h2>Job Discussion Forum</h2>

<form id="discussionForm">
  <input type="text" name="name" placeholder="Your Name" required>
  <input type="text" name="job" placeholder="Job You Are Looking For (optional)">
  <textarea name="comment" placeholder="Your Comment" required></textarea>
  <button type="submit">Submit</button>
</form>

<h3>All Discussions</h3>
<div id="discussionList"></div>

<script>
  const webAppUrl = "https://script.google.com/macros/s/AKfycbyXigj1eROgPerwyJNYG1iYJBLCs0wVrby40ya0zVNi_HMy0Ki5RCN7DlE-LcuIKxC2vg/exec"; // replace with your deployed Apps Script URL
  const form = document.getElementById("discussionForm");
  const discussionDiv = document.getElementById("discussionList");

  form.addEventListener("submit", function(e){
    e.preventDefault();
    fetch(webAppUrl, { method: "POST", body: new FormData(form) })
      .then(res => res.text())
      .then(response => {
        alert(response);
        form.reset();
        loadDiscussions();
      });
  });

  function loadDiscussions() {
    fetch(webAppUrl)
      .then(res => res.json())
      .then(data => {
        discussionDiv.innerHTML = "";
        data.reverse().forEach(item => { // newest first
          const div = document.createElement("div");
          div.classList.add("discussion-box");
          div.innerHTML = `<strong>${item.name}</strong>` +
                          (item.job ? ` (Looking for: <em>${item.job}</em>)` : '') +
                          `: ${item.comment}` +
                          `<div class="timestamp">${item.timestamp}</div>`;
          discussionDiv.appendChild(div);
        });
      });
  }

  loadDiscussions(); // initial load
</script>

</body>
</html>
