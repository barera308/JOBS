<!DOCTYPE html>
<html>
<head><title>Test Comment Post</title></head>
<body>

<form id="commentForm">
  <input type="text" id="name" placeholder="Your Name" required />
  <textarea id="text" placeholder="Your Comment" required></textarea>
  <button type="submit">Send Comment</button>
</form>

<div id="status"></div>

<script>
  const endpoint = 'https://script.google.com/macros/s/AKfycbwRNeoeKfTtrxX1yOzEy_CTAa409RI6IHBzobwud4qUBo3yDWIatiZfkuPlaZp0XoUo/exec'; // Replace this with your Apps Script URL

document.getElementById('commentForm').addEventListener('submit', async (e) => {
  e.preventDefault();

  const name = document.getElementById('name').value.trim() || 'Anonymous';
  const text = document.getElementById('text').value.trim();

  if (!text) {
    alert('Comment cannot be empty');
    return;
  }

  const comment = {
    id: 'c' + Math.random().toString(36).substring(2, 9),
    name,
    text,
    ts: Date.now(),
    replies: []
  };

  try {
    const res = await fetch(endpoint, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({ action: 'addComment', comment })
    });

    const data = await res.json();

    if (data.status === 'success') {
      document.getElementById('status').textContent = 'Comment posted!';
      e.target.reset();
    } else {
      document.getElementById('status').textContent = 'Error: ' + (data.message || 'Unknown error');
    }
  } catch (error) {
    document.getElementById('status').textContent = 'Error sending comment.';
    console.error('Send error:', error);
  }
});
</script>

</body>
</html>
