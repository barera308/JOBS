<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Server Advertisements ‚Äì Job Alerts Pakistan</title>
    <link rel="canonical" href="https://www.jobadvertisments.com.pk/" />

    <!-- KEEP your site verification if present -->
    <meta name="google-site-verification" content="PRRrt7X2_Bozeoj4s2PxyAnvzWzzv97LjlX_u1QBjQ" />

    <!-- ====== GOOGLE ADSENSE: Put this ONCE in <head> on every page ======
         Replace the client value with your publisher ID (ca-pub-9084951287340288)
         This enables Auto ads and allows Google to evaluate the page.
         Do NOT add duplicate copies of this script. ====== -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9084951287340288"
     crossorigin="anonymous"></script>

    <!-- Styles (kept inline for simplicity) -->
    <link rel="stylesheet" href="style.css" />
    <style>
        /* Action Buttons (Post Job + Create CV) */
        .action-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .action-buttons a {
            display: inline-block;
            padding: 10px 18px;
            border-radius: 6px;
            font-weight: bold;
            text-decoration: none;
            transition: background 0.3s;
            color: #fff;
        }

        .btn-job { background: #007bff; }
        .btn-job:hover { background: #0056b3; }

        .btn-cv { background: #28a745; }
        .btn-cv:hover { background: #218838; }

        /* Basic job card styling */
        .job-card { border: 1px solid #eee; padding: 12px; margin: 12px 0; border-radius: 6px; }
        .job-card h3 { margin: 0 0 6px 0; }
        .job-buttons { margin-top: 10px; }
        .btn { padding: 6px 10px; text-decoration: none; border-radius: 4px; display:inline-block; }
        .btn-primary { background:#007bff; color:#fff }
        .btn-secondary { background:#6c757d; color:#fff }
        .btn-success { background:#28a745; color:#fff }
        .share-menu { display:none; margin-top:8px; }
    </style>
</head>
<body>
    <header>
        <nav>
            <a href="index.html">Home</a>
            <a href="jobposting.html">User Jobs</a>
            <a href="about.html">About Us</a>
            <a href="chat.html">Discussion</a>
            <a href="privacy.html">Privacy Policy</a>
            <a href="disclaimer.html">Disclaimer</a>
            <a href="terms.html">Terms &amp; Conditions</a>
            <a href="contact.html">Contact Us</a>
            <a href="results.html">Results</a>
        </nav>
        <h1>Pakistan Job Alerts</h1>
        <p>Stay updated with the newest job opportunities across the country</p>
    </header>

    <main>
        <section class="jobs">
            <h2>Recent Job Ads</h2>

            <!-- Highlighted Action Buttons -->
            <div class="action-buttons">
                <a href="https://forms.gle/ivBbcnFWXPNTNwyg9" target="_blank" class="btn-job">‚ûï Post a Job</a>
                <a href="Create_cv.html" class="btn-cv">üìÑ Create Your CV</a>
            </div>

            <!-- Optional: a small TEST ad unit (replace data-ad-slot with your actual slot ID).
                 This is only for testing manual ad rendering ‚Äî Auto ads do not require this.
                 Remove this block if you prefer Auto-only. -->
            <!--
            <ins class="adsbygoogle"
                 style="display:block; text-align:center;"
                 data-ad-client="ca-pub-9084951287340288"
                 data-ad-slot="REPLACE_WITH_YOUR_SLOT_ID"
                 data-ad-format="auto"
                 data-full-width-responsive="true"></ins>
            <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
            -->

            <!-- Search + Sort -->
            <div class="controls">
                <div class="search-bar">
                    <input type="text" id="search-input" placeholder="Search job titles..." />
                    <button onclick="renderJobs()" aria-label="Search Jobs">üîç</button>
                </div>

                <div class="sort">
                    <label for="sort-select">Sort by:</label>
                    <select id="sort-select" onchange="renderJobs()">
                        <option value="soonest">Oldest Deadline</option>
                        <option value="latest" selected>Latest Deadline</option>
                    </select>
                </div>
            </div>

            <!-- Job List -->
            <div id="job-list">Loading jobs...</div>

            <!-- Pagination -->
            <div class="pagination">
                <button id="prev-btn" onclick="prevPage()">Previous</button>
                <span id="page-info"></span>
                <button id="next-btn" onclick="nextPage()">Next</button>
            </div>
        </section>
    </main>

    <!-- Social Links -->
    <div class="social-links">
        <a href="https://www.facebook.com/computersciencejobsppsc/" target="_blank" rel="noopener" class="facebook">
            <img src="https://upload.wikimedia.org/wikipedia/commons/5/51/Facebook_f_logo_%282019%29.svg" alt="Facebook"> Facebook Page
        </a>
        <a href="https://whatsapp.com/channel/0029VbAOCS84o7qIx6dZ390k" target="_blank" rel="noopener" class="whatsapp">
            <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="WhatsApp"> WhatsApp Channel
        </a>
    </div>

    <footer>
        <p>¬© 2025 Server Advertisements. All rights reserved.</p>
    </footer>

<script>
/* ---------- Job fetching & display logic (unchanged except small robustness tweaks) ---------- */
let jobsData = [];
let currentPage = 1;
const jobsPerPage = 10;
let currentSearch = '';
let currentSort = 'latest';

function parseDate(dateStr) {
    if (!dateStr) return null;
    const gsMatch = String(dateStr).match(/Date\((\d+),\s*(\d+),\s*(\d+)\)/);
    if (gsMatch) {
        // Google Sheets Date() typically returns year, monthIndex (0-based), day
        const y = parseInt(gsMatch[1], 10);
        const m = parseInt(gsMatch[2], 10); // month is already 0-based in this format
        const d = parseInt(gsMatch[3], 10);
        return new Date(y, m, d);
    }
    const isoMatch = String(dateStr).match(/^(\d{4})-(\d{2})-(\d{2})$/);
    if (isoMatch) return new Date(parseInt(isoMatch[1],10), parseInt(isoMatch[2],10) - 1, parseInt(isoMatch[3],10));
    const fallbackDate = new Date(dateStr);
    return !isNaN(fallbackDate) ? fallbackDate : null;
}

function formatDeadline(dateStr) {
    const date = parseDate(dateStr);
    if (!date) return "No deadline";
    return date.toLocaleDateString('en-GB', { day: '2-digit', month: 'short', year: 'numeric' });
}

async function loadJobsFromSheet() {
    const sheetId = "1_n6qYGMfMG2xNVkCzbr71Jjl4NfTSyV0aaas_tXgGIg";
    const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json`;
    try {
        const res = await fetch(url);
        const text = await res.text();
        const json = JSON.parse(text.substr(47).slice(0, -2));
        const rows = json.table.rows || [];
        jobsData = rows.map(row => ({
            title: row.c[0]?.v || '',
            location: row.c[1]?.v || '',
            deadline: row.c[2]?.v || '',
            link: row.c[3]?.v || '#',
            description: row.c[4]?.v || '',
            originalAd: row.c[5]?.v || ''
        }));
        renderJobs();
    } catch (error) {
        console.error("Error loading jobs from sheet:", error);
        document.getElementById('job-list').innerText = "‚ùå Failed to load jobs.";
    }
}

function renderJobs() {
    const searchQuery = currentSearch.toLowerCase();
    const sortOption = currentSort;

    let filteredJobs = jobsData
        .filter(job =>
            job.title.toLowerCase().includes(searchQuery) ||
            job.description.toLowerCase().includes(searchQuery)
        )
        .sort((a, b) => {
            const dateA = parseDate(a.deadline) || new Date(8640000000000000);
            const dateB = parseDate(b.deadline) || new Date(8640000000000000);
            return sortOption === 'latest' ? dateB - dateA : dateA - dateB;
        });

    const totalPages = Math.ceil(filteredJobs.length / jobsPerPage);
    if (currentPage > totalPages) currentPage = totalPages || 1;

    const start = (currentPage - 1) * jobsPerPage;
    const end = start + jobsPerPage;
    const currentJobs = filteredJobs.slice(start, end);

    function highlight(text, query) {
        if (!query) return text;
        const regex = new RegExp(`(${query.replace(/[\-\/\\^$*+?.()|[\]{}]/g, '\\$&')})`, 'gi');
        return text.replace(regex, '<mark>$1</mark>');
    }

    document.getElementById('job-list').innerHTML = currentJobs.map(job => `
        <div class="job-card" data-deadline="${job.deadline}">
            <h3>
                <a href="${job.link}" target="_blank" rel="noopener">
                    ${highlight(job.title, searchQuery)}
                </a>
            </h3>
            <p><strong>Location:</strong> ${job.location}</p>
            <p class="deadline"><strong>Deadline:</strong> ${formatDeadline(job.deadline)}</p>
            <p>${highlight(job.description, searchQuery)}</p>
            <div class="job-buttons">
                <a href="${job.link}" target="_blank" rel="noopener" class="btn btn-primary">View Details</a>
                ${job.originalAd && !job.originalAd.includes('dealcheck') ? `<a href="${job.originalAd}" target="_blank" rel="noopener" class="btn btn-secondary">View Original Ad</a>` : ''}
                <button onclick="toggleShareMenu(this)" class="btn btn-success">Share</button>
            </div>
            <div class="share-menu">
                <a href="#" onclick="shareOnFacebook(event, this)">Facebook</a> |
                <a href="#" onclick="shareOnTwitter(event, this)">Twitter</a> |
                <a href="#" onclick="shareOnLinkedIn(event, this)">LinkedIn</a> |
                <a href="#" onclick="shareByEmail(event, this)">Email</a> |
                <a href="#" onclick="shareOnWhatsApp(event, this)">WhatsApp</a>
            </div>
        </div>
    `).join('');

    document.getElementById('page-info').textContent = `Page ${currentPage} of ${totalPages || 1}`;
    document.getElementById('prev-btn').disabled = currentPage === 1;
    document.getElementById('next-btn').disabled = currentPage >= totalPages;
}

// Search and sort handlers
const searchInput = document.getElementById('search-input');
if (searchInput) {
    searchInput.addEventListener('input', (e) => {
        currentSearch = e.target.value;
        currentPage = 1;
        renderJobs();
    });
}

const sortSelect = document.getElementById('sort-select');
if (sortSelect) {
    sortSelect.addEventListener('change', (e) => {
        currentSort = e.target.value;
        renderJobs();
    });
}

// Pagination buttons
function nextPage() { currentPage++; renderJobs(); }
function prevPage() { currentPage--; renderJobs(); }

// Share menu & social functions
function toggleShareMenu(button) {
    const menu = button.nextElementSibling;
    menu.style.display = menu.style.display === 'block' ? 'none' : 'block';
}
function shareOnFacebook(e, el) { e.preventDefault(); window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(el.closest('.job-card').querySelector('a').href)}`); }
function shareOnTwitter(e, el) { e.preventDefault(); window.open(`https://twitter.com/intent/tweet?url=${encodeURIComponent(el.closest('.job-card').querySelector('a').href)}`); }
function shareOnLinkedIn(e, el) { e.preventDefault(); window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(el.closest('.job-card').querySelector('a').href)}`); }
function shareByEmail(e, el) { e.preventDefault(); window.location.href = `mailto:?subject=Check out this job&body=${encodeURIComponent(el.closest('.job-card').querySelector('a').href)}`; }
function shareOnWhatsApp(e, el) { e.preventDefault(); window.open(`https://api.whatsapp.com/send?text=${encodeURIComponent(el.closest('.job-card').querySelector('a').href)}`); }

// Init
document.addEventListener('DOMContentLoaded', loadJobsFromSheet);
</script>

<!-- NOTES & NEXT STEPS (keep as comments in your file):
     1) Add an ads.txt file at https://yourdomain.com/ads.txt with the line:
        google.com, pub-9084951287340288, DIRECT, f08c47fec0942fa0
     2) Make sure this domain is added & approved in your AdSense account (Sites).
     3) Test in an incognito window with ad-blockers disabled. Check DevTools Console + Network for requests to pagead2.googlesyndication.com.
     4) Allow up to 48 hours for Auto ads to start appearing after initial setup.
-->

</body>
</html>
