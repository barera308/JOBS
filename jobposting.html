<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="google-site-verification" content="PRRrt7X2_Bozeoj4s2PxyAnvzWzzv97LjlX_u1QBjQ" />
  
  <!-- Google AdSense script -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9084951287340288"></script>
  
  <link rel="stylesheet" href="style.css"/>
  
  <title>User Submitted Jobs</title>
  
</head>
<body>
  <header>
    <nav>
      <a href="index.html">Home</a> |
      <a href="jobposting.html">User Jobs</a> |
      <a href="about.html">About Us</a> |
      <a href="chat.html">Discussion</a> |
      <a href="privacy.html">Privacy Policy</a> |
      <a href="disclaimer.html">Disclaimer</a> |
      <a href="terms.html">Terms & Conditions</a> |
      <a href="contact.html">Contact Us</a> |
      <a href="https://forms.gle/ivBbcnFWXPNTNwyg9" target="_blank">‚ûï Post a Job</a>
    </nav>
    <h1>Job Advertisements</h1>
  </header>

  <h1>üìå User Submitted Jobs</h1>
  <div id="jobs" class="job-list">Loading jobs...</div>

  <script>
    const csvUrl = "https://docs.google.com/spreadsheets/d/1ySAiaip6_80lNkTEAMiAZ_U2j9w0T4hcglMIsGa4h5c/export?format=csv&sheet=Sheet1";

    // Simple CSV parser that handles quoted commas
    function parseCSV(str) {
      const rows = [];
      let current = [];
      let inQuotes = false;
      let value = "";

      for (let i = 0; i < str.length; i++) {
        const char = str[i];
        const nextChar = str[i+1];

        if (char === '"' && inQuotes && nextChar === '"') {
          value += '"';
          i++; // skip next quote
        } else if (char === '"') {
          inQuotes = !inQuotes;
        } else if (char === ',' && !inQuotes) {
          current.push(value);
          value = "";
        } else if ((char === '\n' || char === '\r') && !inQuotes) {
          if (value || value === "") current.push(value);
          if (current.length > 1 || current[0] !== "") rows.push(current);
          current = [];
          value = "";
          if (char === '\r' && nextChar === '\n') i++; // handle \r\n
        } else {
          value += char;
        }
      }
      if (value || value === "") current.push(value);
      if (current.length > 0) rows.push(current);
      return rows;
    }

    fetch(csvUrl)
      .then(res => res.text())
      .then(data => {
        const rows = parseCSV(data);
        const headers = rows[0]; // first row = column names
        const jobs = rows.slice(1).filter(r => r.length > 1);

        const jobsContainer = document.getElementById("jobs");
        jobsContainer.innerHTML = "";

        if (jobs.length === 0) {
          jobsContainer.innerHTML = "<p>No user-submitted jobs yet.</p>";
          return;
        }

        jobs.forEach(r => {
          const job = {
            timestamp: r[0] || "",
            title: r[1] || "",
            company: r[2] || "",
            location: r[3] || "",
            deadline: r[4] || "",
            type: r[5] || "",
            description: r[6] || "",
            applyLink: r[7] || "#",
            originalAd: r[8] || ""
          };

          const jobCard = document.createElement("div");
          jobCard.className = "job-card";
          jobCard.innerHTML = `
            <h3>${job.title}</h3>
            <p><b>Company:</b> ${job.company}</p>
            <p><b>Location:</b> ${job.location}</p>
            <p><b>Deadline:</b> ${job.deadline}</p>
            <p><b>Type:</b> ${job.type}</p>
            <p>${job.description}</p>
            <a href="${job.applyLink}" target="_blank">Apply Now</a>
            ${job.originalAd ? `<a class="ad-link" href="${job.originalAd}" target="_blank">üìÑ View Original Advertisement</a>` : ""}
          `;
          jobsContainer.appendChild(jobCard);
        });
      })
      .catch(err => {
        console.error("Error loading jobs:", err);
        document.getElementById("jobs").innerHTML = "<p>‚ùå Failed to load user-submitted jobs.</p>";
      });
  </script>
</body>
</html>

